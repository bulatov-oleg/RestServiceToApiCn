<!DOCTYPE html>
<html lang="ru-RU" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security" >

<head th:replace="~{header_bs ::head_ccs_bs}"></head>
<head>
    <!--<link href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/4.1.1/css/bootstrap/tabulator_bootstrap.min.css" rel="stylesheet">-->
    <!--<link href="/lib/tabulator/tabulator_simple.min.css" rel="stylesheet">-->
    <link href="/lib/tabulator/tabulator_semantic-ul.min.css" rel="stylesheet">
    <script type="text/javascript" src="/lib/tabulator/tabulator_4.1.1_js_tabulator.js"></script>
</head>


<body>
    <div th:replace="~{header_bs ::top}"></div>
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-sm-12">
                <h3> Внимательно изменяем данные</h3>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 col-sm-12">
            <form class="form" role="form" action="/admin/editUserSave" method="post">
            <h4>
                <span th:utext="'Имя пользователя : '+${user.username}"}> Должно быть Имя пользователя</span>
                <br>
            </h4>
            <div class="form-group">
            <label>Роли:</label>
            <div th:each="role:${rolesMap}">
                <input   th:if="${role.getValue()== true}" type="checkbox"
                        th:id="${role.getKey()}" th:name="${role.getKey()}" th:value="${role.getKey()}" checked >
                <input   th:if="${role.getValue()!= true}" type="checkbox"
                        th:id="${role.getKey()}" th:name="${role.getKey()}" th:value="${role.getKey()}">
                <label th:for="${role.getKey()}">
                    <span th:utext="${role.getKey()}">Роль1</span>
                    <br>
                </label>
            </div>
            </div>

            <div class="form-group">
                <label for="active">Активен</label>
                <input  type="checkbox"  name="active" id="active" th:value="${user.getActive()}"
                        th:checked="${user.getActive()}">
            </div>


            <div class="form-group">
                <label for="newPassword">Новый пароль</label>
                <input type="password" name="newPassword" id="newPassword" placeholder="заполните для изменения">
            </div>
            <div class="form-group">
                <label for="repPassword">Повторите пароль</label>
                <input type="password" name="repPassword"  id="repPassword" placeholder="заполните для изменения" >
            </div>
            <input class="sr-only" type="hidden" th:name="username" th:value="${user.username}">
            <input class="sr-only" type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <div class="form-group">
                <button  class="btn btn-success" type="submit" value="Сохранить" name="save" onclick="return confirmSave()">
                    <span>Сохранить</span></button>
                <button  class="btn btn-primary" type="submit" value="Отменить" name="cancel">
                    <span>Отменить</span>
                </button>
            </div>
            <div class="form-group">
                <button  class="btn btn-danger" type="submit" value="Удалить" name="delete" onclick="return confirmDelete()">
                    <span th:utext="'Удалить '+${user.username}"></span>
                </button>
            </div>
            </form>
            </div>
        </div>
    </div>

</body>
<!--<div th:insert="~{footer ::footer}"></div>-->


<script th:inline="javascript">
    function confirmDelete(){return confirm("Удаляем пользователя?");}
    function confirmSave(){
        if($("#newPassword").val()!=$("#repPassword").val()){
            alert("Пароли не совпадают");
            return 0;
        }
        return confirm("Сохраняем изменения?");
    }
    window.addEventListener('resize', function () {
        table.redraw(true); //trigger full rerender including all data and rows
    });

 </script>
</html>
